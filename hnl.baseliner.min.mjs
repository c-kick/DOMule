import eventHandler from"./hnl.eventhandler.mjs";import{isVisible}from"./hnl.helpers.mjs";import{hnlLogger}from"./hnl.logger.mjs";export const NAME="baseLiner";const BASELINE_VAR="--grid-base";const BLOCK_ELEMENTS=["img"];const BASELINE_GRID_CLASS=".align-baseline-grid";function gcd(a,b){if(b>a)[a,b]=[b,a];while(b!==0)[a,b]=[b,a%b];return a}function ratio(x,y){let c=gcd(x,y);return`${x/c} / ${y/c}`}function conformToBaseline(el){el.style.setProperty("aspect-ratio",null);window.requestAnimationFrame(function(){let gridSize=
parseFloat(window.getComputedStyle(el).getPropertyValue(BASELINE_VAR));let rect=el.getBoundingClientRect();let roundedHeight=Math.ceil(rect.height/gridSize)*gridSize;el.style.setProperty("aspect-ratio",ratio(rect.width,roundedHeight))})}function correctInlineGridElements(){document.querySelectorAll(BASELINE_GRID_CLASS+" "+BLOCK_ELEMENTS.join(", "+BASELINE_GRID_CLASS+" ")).forEach(function(el){if(el.classList.contains("no-baseline-adjust"))return;const adjustEl=el.closest("figure")||el;if(el.complete)conformToBaseline(adjustEl);
else if(typeof el.complete!=="undefined")el.onload=function(){conformToBaseline(adjustEl)};else conformToBaseline(adjustEl)})}eventHandler.breakPointChange(function(e){if(e.detail.matches)correctInlineGridElements()});export function init(elements){correctInlineGridElements()};
