import{debounceThis}from"./hnl.debounce";import{hnlLogger}from"./hnl.logger";export const NAME="sliderHandler";export function init(sliders,parent,changeCallback){let slidersObject={};sliders.forEach(function(slider){const sliderObject={element:slider,name:slider.name.toString(),range:(slider.max?slider.max:100)-(slider.min?slider.min:0)||100,value:slider.value,tgt:slider.dataset.target?document.getElementById(slider.dataset.target):null,targetControl:slider.dataset.target&&slider.dataset.targetControl||
false,siblings:sliders,parent:parent?parent:null,trigger:"self",update:debounceThis(event=>{sliderObject.value=typeof event==="string"||typeof event==="number"?parseFloat(event):event.target.value;if(event.target&&event.target===sliderObject.element){sliderObject.trigger="self";if(sliderObject.targetControl)sliderObject.tgt.value=sliderObject.tgt.innerHTML=sliderObject.value}else if(event.target&&event.target===sliderObject.tgt){sliderObject.trigger="target";sliderObject.element.value=sliderObject.value}else{sliderObject.trigger=
"external";if(sliderObject.targetControl)sliderObject.tgt.value=sliderObject.tgt.innerHTML=sliderObject.value;sliderObject.element.value=sliderObject.value}slider.style.setProperty("--slider-value",((sliderObject.value-(slider.min?slider.min:0))/sliderObject.range*100).toFixed(2)+"%");if(typeof changeCallback==="function")changeCallback.call(this,sliderObject);slider.dispatchEvent(new Event("slider-change",{bubbles:true,data:{slider:sliderObject}}))},{threshold:10,execFirst:false,execWhile:true,execLast:true}),
valueToPercentage:function(value){value=parseFloat(value);return(value-(slider.min?slider.min:0))/sliderObject.range*100}};sliderObject.element.addEventListener("input",sliderObject.update);sliderObject.element.addEventListener("change",sliderObject.update);if(sliderObject.targetControl)sliderObject.tgt.addEventListener("input",sliderObject.update);slider.style.setProperty("--slider-value",sliderObject.valueToPercentage(sliderObject.element.value).toFixed(2)+"%");slider.slider=sliderObject;slidersObject[sliderObject.name]=
sliderObject;hnlLogger.log(NAME,`Slider ${sliderObject.name} has been set-up`)});return slidersObject};
