import Collapse from"../libs/bs-5.2.0/src/collapse.js";import{isVisible}from"./hnl.helpers.mjs";export function init(elements){elements.forEach(element=>{if(element.classList.contains("accordion")){element.querySelectorAll(".accordion-item").forEach(accordionItem=>{if(`#${accordionItem.querySelector(".jumplink").getAttribute("id")}`===window.location.hash)Collapse.getOrCreateInstance(accordionItem.querySelector(".collapse"),{}).show()});element.addEventListener("shown.bs.collapse",event=>{const measure=
event.target.closest(".accordion-item")?event.target.closest(".accordion-item"):event.target;if(!element.classList.contains("accordion-no-hash")){const id=(measure.closest(".jumplink")||measure.querySelector(".jumplink")).getAttribute("id");history.replaceState(null,null,`#${id}`)}let deductHeight=parseFloat(document.documentElement.style.getPropertyValue("--site-header-height"));if(document.querySelector(".accordion .position-sticky.stuck"))deductHeight+=document.querySelector(".accordion .position-sticky.stuck").offsetHeight;
isVisible(measure,(visible,rect,vp)=>{if(!visible)if(rect.bottom>vp.bottom&&rect.height<vp.bottom-vp.top)window.scrollTo({top:rect.bottom-vp.bottom+(window.pageYOffset||document.documentElement.scrollTop),left:0,behavior:"auto"});else if(rect.top<vp.top)window.scrollTo({top:rect.pageY-deductHeight,left:0,behavior:"auto"})},{top:deductHeight})})}})};
